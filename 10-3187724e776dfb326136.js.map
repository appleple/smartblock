{"version":3,"sources":["webpack:///./node_modules/smartblock/lib/components/smartblock.js","webpack:///./node_modules/smartblock/lib/utils/hooks.js","webpack:///./node_modules/smartblock/lib/components/title.js","webpack:///./node_modules/smartblock/lib/components/menu.js","webpack:///./node_modules/smartblock/lib/components/icons/undo.js","webpack:///./node_modules/scroll-to/index.js","webpack:///./node_modules/smartblock/lib/components/inline-menu.js","webpack:///./node_modules/smartblock/lib/extensions/base.js","webpack:///./node_modules/ev-emitter/ev-emitter.js","webpack:///./node_modules/smartblock/lib/components/custom-layout.js","webpack:///./node_modules/smartblock/lib/components/edit-menu.js","webpack:///./node_modules/component-tween/index.js","webpack:///./node_modules/component-raf/index.js","webpack:///./node_modules/component-tween/node_modules/component-emitter/index.js","webpack:///./node_modules/smartblock/lib/components/editor.js","webpack:///./node_modules/component-clone/index.js","webpack:///./node_modules/ease-component/index.js","webpack:///./node_modules/smartblock/lib/components/back-btn.js","webpack:///./node_modules/component-type/index.js","webpack:///./node_modules/imagesloaded/imagesloaded.js"],"names":["__assign","this","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__spreadArray","to","from","pack","ar","l","Array","slice","concat","defineProperty","exports","value","React","prosemirror_model_1","prosemirror_keymap_1","prosemirror_commands_1","scroll_to_1","classnames_1","uuid","editor_1","inline_menu_1","edit_menu_1","menu_1","back_btn_1","custom_layout_1","title_1","utils_1","base_1","useState","useEffect","useRef","getMarks","extensions","filter","extension","group","getSchemaFromExtensions","nodes","schema","reduce","node","curr","index","_a","newNode","name","getBlockSchemas","nodeDependencies","schemaDependencies","getSchemaBlockDependencies","doc","content","text","hard_break","inline","selectable","parseDOM","tag","toDOM","marks","mark","newMark","getMarkSchemas","Schema","getMenu","showMenu","getPlugins","customPlugins","forEach","plugins","keyPlugin","extensionKeys","keys","registeredKeys_1","key","push","keyMaps","extensionKey","chainCommands","keymap","getKeys","default","props","defaultProps","offsetTop","showBackBtn","autoSave","showTitle","titleText","full","html","json","markdown","showdown","realHtml","Node","fromJSON","getHtmlFromNode","converter","Converter","setFlavor","makeHtml","pathname","location","localHtml","localStorage","getItem","options","setOptions","app","div","document","createElement","innerHTML","DOMParser","fromSchema","parse","preserveWhitespace","onInit","getEditorRef","editorOptions","_b","showMenus","setShowMenus","containerId","useMemo","container","blocks","getBlocks","edits","getEdits","nodeViews","views","view","getPos","getNodeViews","id","onClick","e","target","getAttribute","ref","className","onChange","title","setItem","onTitleChange","titleChanged","defaultValue","state","dispatch","current","selected","querySelector","viewport","getViewport","top_1","getScrollTop","height","getOffset","top","test","navigator","platform","activeElement","duration","isContentEditable","change","toJSON","outputMarkdown","makeMd","childCount","lastNode","child","type","paragraph","tr","insert","size","createAndFill","textContent","setTimeout","render","editor","scrolling","Fragment","menu","getParentNodeFromState","currentBlock","find","block","hideInlineMenuOnFocus","shouldRenderInlineMenu","blockMenu","useScrolling","useScroll","useView","useForceUpdate","react_1","prosemirror_state_1","prosemirror_view_1","_1","setTick","tick","forceUpdate","EditorView","EditorState","create","dispatchTransaction","transaction","applyTransaction","transactions","updateState","some","docChanged","attributes","scrollTop","setScrollTop","scrollEvent","window","addEventListener","removeEventListener","element","delay","setScrolling","debounceTimer","count","getBoundingClientRect","interval","setInterval","localTop","clearTimeout","clearInterval","hooks_1","schemaDef","titleRef","config","replace","Plugin","decorations","descendants","pos","isBlock","Decoration","nodeSize","class","DecorationSet","appendChild","dom","prosemirror_utils_1","button_1","CustomMenu","activeItem","item","active","customMenu","getActiveMenu","shouldRender","selectedItem","hideMenuOnFocus","shouldRenderMenu","left","style","setState","nextStyle","selection","empty","right","$anchor","rowNumber","resolve","path","firstNode","findChildren","_node","coords","coordsAtPos","nodeDOM","elementTop","offsetHeight","calculateStyle","hideBlockMenuOnFocus","map","customButton","disabled","enable","preventDefault","icon","dangerouslySetInnerHTML","__html","children","width","viewBox","d","Tween","raf","module","x","y","start","pageYOffset","documentElement","pageXOffset","scrollLeft","scroll","tween","ease","animate","update","o","scrollTo","on","offsetLeft","$head","offsetWidth","innerWidth","calculateArrowPos","inlineMenu","customInlineMenu","getActiveInlineMenu","paragraph_1","trash_1","move_up_1","move_down_1","default_keys_1","default_plugins_1","EvEmitter","proto","eventName","listener","events","_events","listeners","indexOf","once","onceEvents","_onceEvents","off","splice","emitEvent","args","onceListeners","allOff","imagesloaded_1","customLayout","getCustomLayout","parentNode","parentPos","findNodePosition","position","zIndex","setSize","newSize","useImagesLoaded","color","btnColor","Emitter","clone","obj","_from","reset","isArray","_curr","_done","_start","Date","now","_to","ms","_duration","fn","TypeError","_ease","stop","stopped","emit","step","_update","k","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","getTime","Math","max","prev","req","cancel","cancelAnimationFrame","webkitCancelAnimationFrame","mozCancelAnimationFrame","mixin","event","_callbacks","removeListener","removeAllListeners","cb","callbacks","len","hasListeners","editorRef","autoFocus","focus","_","copy","flags","multiline","global","ignoreCase","RegExp","source","linear","inQuad","outQuad","inOutQuad","inCube","outCube","inOutCube","inQuart","outQuart","inOutQuart","inQuint","outQuint","inOutQuint","inSine","cos","PI","outSine","sin","inOutSine","inExpo","pow","outExpo","inOutExpo","inCirc","sqrt","outCirc","inOutCirc","inBack","outBack","inOutBack","inBounce","outBounce","inOutBounce","prosemirror_history_1","undo_1","undoDepth","undo","toString","val","undefined","nodeType","valueOf","factory","$","jQuery","console","extend","a","b","prop","arraySlice","ImagesLoaded","elem","onAlways","queryElem","querySelectorAll","elements","getImages","jqDeferred","Deferred","check","bind","error","images","addElementImages","nodeName","addImage","background","addElementBackgroundImages","elementNodeTypes","childImgs","img","1","9","11","LoadingImage","Background","url","Image","getComputedStyle","reURL","matches","exec","backgroundImage","addBackground","loadingImage","_this","onProgress","image","message","progress","progressedCount","hasAnyBroken","complete","isLoaded","notify","debug","log","isComplete","jqMethod","getIsImageComplete","confirm","naturalWidth","proxyImage","src","handleEvent","method","onload","unbindEvents","onerror","makeJQueryPlugin","imagesLoaded","callback","promise"],"mappings":"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","file":"10-3187724e776dfb326136.js","sourcesContent":["\"use strict\";\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nvar __spreadArray = this && this.__spreadArray || function (to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n    if (ar || !(i in from)) {\n      if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n      ar[i] = from[i];\n    }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar React = require(\"react\");\nvar prosemirror_model_1 = require(\"prosemirror-model\");\nvar prosemirror_keymap_1 = require(\"prosemirror-keymap\");\nvar prosemirror_commands_1 = require(\"prosemirror-commands\");\nvar scroll_to_1 = require(\"scroll-to\");\nvar classnames_1 = require(\"classnames\");\nvar uuid = require(\"uuid/v4\");\nvar editor_1 = require(\"./editor\");\nvar inline_menu_1 = require(\"./inline-menu\");\nvar edit_menu_1 = require(\"./edit-menu\");\nvar menu_1 = require(\"./menu\");\nvar back_btn_1 = require(\"./back-btn\");\nvar custom_layout_1 = require(\"./custom-layout\");\nvar title_1 = require(\"./title\");\nvar utils_1 = require(\"../utils\");\nvar base_1 = require(\"../extensions/base\");\nvar useState = React.useState,\n  useEffect = React.useEffect,\n  useRef = React.useRef;\nvar EDITMENUHEIGHT = 80;\nvar getBlockSchemas = function (extensions) {\n  var nodesSchema = extensions.filter(function (extension) {\n    if (extension.schema && extension.schema.group === 'block') {\n      return true;\n    }\n    return false;\n  });\n  var nodes = nodesSchema.reduce(function (node, curr, index) {\n    var _a;\n    var newNode = (_a = {}, _a[curr.name] = __assign({}, curr.schema), _a);\n    return __assign(__assign({}, node), newNode);\n  }, {});\n  return nodes;\n};\nvar getBlocks = function (extensions) {\n  var nodesSchema = extensions.filter(function (extension) {\n    if (extension.group === 'block') {\n      return true;\n    }\n    return false;\n  });\n  return nodesSchema;\n};\nvar getMarks = function (extensions) {\n  var marksSchema = extensions.filter(function (extension) {\n    if (extension.group === 'mark') {\n      return true;\n    }\n    return false;\n  });\n  return marksSchema;\n};\nvar getMarkSchemas = function (extensions) {\n  var marksSchema = getMarks(extensions);\n  var marks = marksSchema.reduce(function (mark, curr, index) {\n    var _a;\n    var newMark = (_a = {}, _a[curr.name] = __assign({}, curr.schema), _a);\n    return __assign(__assign({}, mark), newMark);\n  }, {});\n  return marks;\n};\nvar getEdits = function (extensions) {\n  var editMarks = extensions.filter(function (extension) {\n    if (extension.group === 'edit') {\n      return true;\n    }\n    return false;\n  });\n  return editMarks;\n};\nvar getSchemaBlockDependencies = function (extensions) {\n  var schemas = extensions.reduce(function (schema, curr) {\n    if (curr.schemaDependencies) {\n      return Object.assign({}, schema, curr.schemaDependencies);\n    }\n    return schema;\n  }, {});\n  return schemas;\n};\nvar getSchemaFromExtensions = function (extensions) {\n  var nodes = getBlockSchemas(extensions);\n  var nodeDependencies = getSchemaBlockDependencies(extensions);\n  var base = {\n    doc: {\n      content: 'block+'\n    },\n    text: {\n      group: 'inline'\n    },\n    hard_break: {\n      inline: true,\n      group: 'inline',\n      selectable: false,\n      parseDOM: [{\n        tag: 'br'\n      }],\n      toDOM: function () {\n        return ['br'];\n      }\n    }\n  };\n  nodes = __assign(__assign(__assign({}, nodes), base), nodeDependencies);\n  var marks = getMarkSchemas(extensions);\n  return new prosemirror_model_1.Schema({\n    nodes: nodes,\n    marks: marks\n  });\n};\nvar getKeys = function (extensions, schema) {\n  var extensionKeys = {};\n  extensions.forEach(function (extension) {\n    if (extension.keys) {\n      var registeredKeys_1 = extension.keys(schema);\n      Object.keys(registeredKeys_1).forEach(function (key) {\n        if (!extensionKeys[key]) {\n          extensionKeys[key] = [];\n        }\n        extensionKeys[key].push(registeredKeys_1[key]);\n      });\n    }\n  });\n  var keyMaps = {};\n  Object.keys(extensionKeys).forEach(function (extensionKey) {\n    keyMaps[extensionKey] = prosemirror_commands_1.chainCommands.apply(void 0, extensionKeys[extensionKey]);\n  });\n  return (0, prosemirror_keymap_1.keymap)(keyMaps);\n};\nvar getMenu = function (extensions) {\n  return extensions.filter(function (extension) {\n    return extension.showMenu;\n  });\n};\nvar onChange = function (state, dispatch, props, schema, container, showdown //any\n) {\n  var doc = state.doc;\n  if (container && container.current) {\n    var selected = container.current.querySelector('.selected');\n    if (selected) {\n      var viewport = (0, utils_1.getViewport)();\n      var top_1 = (0, utils_1.getScrollTop)() + viewport.height;\n      var offsetTop = (0, utils_1.getOffset)(selected).top;\n      if (offsetTop + EDITMENUHEIGHT >= top_1) {\n        if (/iPod|iPhone|iPad/.test(navigator.platform) && document.activeElement) {\n          var activeElement = document.activeElement;\n          if (activeElement.isContentEditable) {\n            (0, scroll_to_1.default)(0, offsetTop - EDITMENUHEIGHT, {\n              duration: 300\n            });\n            return true;\n          }\n        } else {\n          (0, scroll_to_1.default)(0, offsetTop - EDITMENUHEIGHT, {\n            duration: 300\n          });\n          return true;\n        }\n      }\n    }\n  }\n  if (props.onChange) {\n    var html = (0, utils_1.getHtmlFromNode)(doc, schema);\n    var change = {\n      json: doc.toJSON(),\n      html: html,\n      schema: schema\n    };\n    if (props.outputMarkdown && showdown) {\n      var converter = new showdown.Converter();\n      converter.setFlavor('github');\n      change.markdown = converter.makeMd(html);\n    }\n    props.onChange(change);\n  }\n  if (props.autoSave) {\n    var pathname = location.pathname;\n    var html = (0, utils_1.getHtmlFromNode)(doc, schema);\n    localStorage.setItem(\"smartblock:\".concat(pathname), html);\n  }\n  var childCount = doc.content.childCount;\n  var lastNode = doc.content.child(childCount - 1);\n  if (lastNode.type.name !== 'paragraph') {\n    var paragraph = state.schema.nodes.paragraph;\n    dispatch(state.tr.insert(state.doc.content.size, paragraph.createAndFill()));\n  } else if (lastNode.textContent.length !== 0) {\n    var paragraph = state.schema.nodes.paragraph;\n    dispatch(state.tr.insert(state.doc.content.size, paragraph.createAndFill()));\n  }\n  return false;\n};\nvar getPlugins = function (extensions, schema) {\n  var customPlugins = [];\n  extensions.forEach(function (extension) {\n    if (extension.plugins) {\n      customPlugins = __spreadArray(__spreadArray([], customPlugins, true), extension.plugins, true);\n    }\n  });\n  var keyPlugin = getKeys(extensions, schema);\n  return __spreadArray(__spreadArray([], customPlugins, true), [keyPlugin], false);\n};\nvar getNodeViews = function (extensions) {\n  var views = {};\n  extensions.forEach(function (extension) {\n    if (extension.view) {\n      views[extension.name] = function (node, view, getPos) {\n        return extension.view(node, view, getPos);\n      };\n    }\n  });\n  return views;\n};\nvar titleChanged = function (title, props) {\n  var pathname = location.pathname;\n  localStorage.setItem(\"smartblock-title:\".concat(pathname), title);\n  if (props.onTitleChange) {\n    props.onTitleChange(title);\n  }\n};\nvar shouldRenderInlineMenu = function (view, blocks) {\n  var node = (0, utils_1.getParentNodeFromState)(view.state);\n  var currentBlock = blocks.find(function (block) {\n    if (block.name === node.type.name) {\n      return true;\n    }\n    return false;\n  });\n  if (currentBlock && currentBlock.hideInlineMenuOnFocus) {\n    return false;\n  }\n  return true;\n};\nexports.default = function (props) {\n  var defaultProps = {\n    extensions: base_1.default,\n    offsetTop: 0,\n    showBackBtn: false,\n    autoSave: false,\n    showTitle: false,\n    titleText: '',\n    full: false\n  };\n  props = Object.assign({}, defaultProps, props);\n  var html = props.html,\n    json = props.json,\n    extensions = props.extensions,\n    showBackBtn = props.showBackBtn,\n    showTitle = props.showTitle,\n    markdown = props.markdown,\n    showdown = props.showdown;\n  var titleText = props.titleText;\n  var schema = getSchemaFromExtensions(props.extensions);\n  var realHtml = html;\n  if (json) {\n    var node = prosemirror_model_1.Node.fromJSON(schema, json);\n    realHtml = (0, utils_1.getHtmlFromNode)(node, schema);\n  }\n  if (markdown && showdown) {\n    var converter = new showdown.Converter();\n    converter.setFlavor('github');\n    realHtml = converter.makeHtml(markdown);\n  }\n  if (props.autoSave) {\n    var pathname = location.pathname;\n    var localHtml = localStorage.getItem(\"smartblock:\".concat(pathname));\n    if (localHtml) {\n      realHtml = localHtml;\n    }\n    if (showTitle) {\n      titleText = localStorage.getItem(\"smartblock-title:\".concat(pathname));\n    }\n  }\n  var _a = useState(null),\n    options = _a[0],\n    setOptions = _a[1];\n  var app = useRef(null);\n  useEffect(function () {\n    var div = document.createElement('div');\n    div.innerHTML = realHtml;\n    var doc = prosemirror_model_1.DOMParser.fromSchema(schema).parse(div, {\n      preserveWhitespace: true\n    });\n    if (props.onInit) {\n      props.onInit({\n        schema: schema\n      });\n    }\n    if (props.getEditorRef) {\n      props.getEditorRef(app);\n    }\n    var editorOptions = {\n      schema: schema,\n      plugins: getPlugins(extensions, schema),\n      doc: doc\n    };\n    setOptions(editorOptions);\n  }, []);\n  var _b = useState(true),\n    showMenus = _b[0],\n    setShowMenus = _b[1];\n  var containerId = React.useMemo(function () {\n    return uuid();\n  }, []);\n  var container = useRef(null);\n  var blocks = getBlocks(extensions);\n  var marks = getMarks(extensions);\n  var edits = getEdits(extensions);\n  var nodeViews = getNodeViews(extensions);\n  return React.createElement(\"div\", {\n    id: containerId,\n    onClick: function (e) {\n      var target = e.target;\n      if (target.getAttribute('id') === containerId) {\n        setShowMenus(false);\n      } else {\n        setShowMenus(true);\n      }\n    },\n    ref: app\n  }, React.createElement(\"div\", {\n    className: (0, classnames_1.default)('smartblock-container', {\n      'is-full': props.full\n    })\n  }, props.showTitle && React.createElement(title_1.default, {\n    onChange: function (title) {\n      titleChanged(title, props);\n    },\n    defaultValue: titleText\n  }), React.createElement(\"div\", {\n    className: \"smartblock-inner\"\n  }, React.createElement(\"div\", {\n    className: showMenus ? '' : 'ProseMirrorHideSelection',\n    ref: container\n  }, React.createElement(\"div\", {\n    className: \"smartblock-input-area\"\n  }, options && React.createElement(editor_1.default, {\n    options: options,\n    nodeViews: nodeViews,\n    onChange: function (state, dispatch) {\n      var shouldScroll = onChange(state, dispatch, props, schema, container, showdown);\n      if (shouldScroll) {\n        setTimeout(function () {\n          setShowMenus(true);\n        }, 700);\n      }\n    },\n    render: function (_a) {\n      var editor = _a.editor,\n        view = _a.view,\n        scrolling = _a.scrolling;\n      if (scrolling) {\n        setShowMenus(false);\n      }\n      return React.createElement(React.Fragment, null, showMenus && React.createElement(React.Fragment, null, React.createElement(menu_1.default, {\n        view: view,\n        menu: getMenu(blocks)\n      }), React.createElement(edit_menu_1.default, {\n        view: view,\n        menu: getMenu(edits)\n      }), shouldRenderInlineMenu(view, blocks) && React.createElement(inline_menu_1.default, {\n        menu: getMenu(marks),\n        blockMenu: getMenu(blocks),\n        view: view\n      }), React.createElement(custom_layout_1.default, {\n        view: view,\n        menu: getMenu(blocks)\n      }), showBackBtn && React.createElement(back_btn_1.default, {\n        view: view\n      })), editor);\n    }\n  }))))));\n};\nfunction deepmarge(schema, schemaDependencies) {\n  throw new Error('Function not implemented.');\n}","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.useScrolling = exports.useScroll = exports.useView = exports.useForceUpdate = void 0;\nvar react_1 = require(\"react\");\nvar prosemirror_state_1 = require(\"prosemirror-state\");\nvar prosemirror_view_1 = require(\"prosemirror-view\");\nvar _1 = require(\".\");\nvar useForceUpdate = function () {\n  var _a = (0, react_1.useState)(0),\n    setTick = _a[1];\n  var update = function () {\n    setTick(function (tick) {\n      return tick + 1;\n    });\n  };\n  return update;\n};\nexports.useForceUpdate = useForceUpdate;\nvar useView = function (props) {\n  var forceUpdate = (0, exports.useForceUpdate)();\n  var instance = (0, react_1.useMemo)(function () {\n    var view = new prosemirror_view_1.EditorView(null, {\n      state: prosemirror_state_1.EditorState.create(props.options),\n      dispatchTransaction: function (transaction) {\n        var _a = view.state.applyTransaction(transaction),\n          state = _a.state,\n          transactions = _a.transactions;\n        view.updateState(state);\n        if (transactions.some(function (tr) {\n          return tr.docChanged;\n        })) {\n          props.onChange(state, view.dispatch);\n        }\n        forceUpdate();\n      },\n      attributes: props.attributes,\n      nodeViews: props.nodeViews\n    });\n    props.onChange(view.state, view.dispatch);\n    return view;\n  }, []);\n  return instance;\n};\nexports.useView = useView;\nvar useScroll = function () {\n  var _a = (0, react_1.useState)((0, _1.getScrollTop)()),\n    scrollTop = _a[0],\n    setScrollTop = _a[1];\n  (0, react_1.useEffect)(function () {\n    var scrollEvent = function () {\n      setScrollTop((0, _1.getScrollTop)());\n    };\n    window.addEventListener('scroll', scrollEvent);\n    return function () {\n      window.removeEventListener('scroll', scrollEvent);\n    };\n  }, [scrollTop]);\n  return scrollTop;\n};\nexports.useScroll = useScroll;\nvar useScrolling = function (element, delay) {\n  var _a = (0, react_1.useState)(false),\n    scrolling = _a[0],\n    setScrolling = _a[1];\n  (0, react_1.useEffect)(function () {\n    var debounceTimer = null;\n    var count = 0;\n    if (!element.current) {\n      return;\n    }\n    var top = element.current.getBoundingClientRect().top;\n    var eventHandler = function () {\n      var localTop = element.current.getBoundingClientRect().top;\n      if (localTop === top) {\n        return;\n      }\n      top = localTop;\n      count++;\n      if (count === 3) {\n        if (scrolling === false) {\n          count = 0;\n          setScrolling(true);\n        }\n      }\n      clearTimeout(debounceTimer);\n      debounceTimer = setTimeout(function () {\n        setScrolling(false);\n        count = 0;\n      }, delay);\n    };\n    var interval = setInterval(eventHandler, 100);\n    return function () {\n      clearInterval(interval);\n    };\n  }, []);\n  return scrolling;\n};\nexports.useScrolling = useScrolling;","\"use strict\";\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar React = require(\"react\");\nvar prosemirror_model_1 = require(\"prosemirror-model\");\nvar prosemirror_state_1 = require(\"prosemirror-state\");\nvar prosemirror_view_1 = require(\"prosemirror-view\");\nvar utils_1 = require(\"../utils\");\nvar hooks_1 = require(\"../utils/hooks\");\nvar useRef = React.useRef,\n  useEffect = React.useEffect;\nvar schemaDef = {\n  nodes: {\n    doc: {\n      content: 'block'\n    },\n    text: {\n      group: 'inline'\n    },\n    title: {\n      group: 'block',\n      content: 'text*',\n      selectable: false,\n      parseDOM: [{\n        tag: 'h1'\n      }],\n      toDOM: function () {\n        return ['h1', 0];\n      }\n    }\n  }\n};\nvar placeholderPlugin = function () {\n  return new prosemirror_state_1.Plugin({\n    props: {\n      decorations: function (state) {\n        var decorations = [];\n        var decorate = function (node, pos) {\n          if (node.type.isBlock && node.childCount === 0) {\n            decorations.push(prosemirror_view_1.Decoration.node(pos, pos + node.nodeSize, {\n              class: 'empty-node'\n            }));\n          }\n        };\n        state.doc.descendants(decorate);\n        return prosemirror_view_1.DecorationSet.create(state.doc, decorations);\n      }\n    }\n  });\n};\nexports.default = function (props) {\n  var defaultProps = {\n    defaultValue: ''\n  };\n  props = Object.assign({}, defaultProps, props);\n  var titleRef = useRef(null);\n  var schema = new prosemirror_model_1.Schema(__assign({}, schemaDef));\n  var div = document.createElement('div');\n  div.innerHTML = props.defaultValue;\n  var doc = prosemirror_model_1.DOMParser.fromSchema(schema).parse(div);\n  var config = {\n    onChange: function (state) {\n      if (props.onChange) {\n        var title = (0, utils_1.getHtmlFromNode)(state.doc, schema);\n        title = title.replace(/<h1>(.*)<\\/h1>/, '$1');\n        props.onChange(title);\n      }\n    },\n    options: {\n      schema: schema,\n      doc: doc,\n      plugins: [placeholderPlugin()]\n    }\n  };\n  var view = (0, hooks_1.useView)(config);\n  useEffect(function () {\n    if (titleRef.current) {\n      titleRef.current.appendChild(view.dom);\n    }\n  }, []);\n  return React.createElement(\"div\", {\n    ref: titleRef,\n    className: \"smartblock-title\"\n  });\n};","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar React = require(\"react\");\nvar prosemirror_utils_1 = require(\"prosemirror-utils\");\nvar utils_1 = require(\"../utils\");\nvar button_1 = require(\"./button\");\nvar useState = React.useState,\n  useEffect = React.useEffect;\nvar calculateStyle = function (props) {\n  var view = props.view;\n  var state = view.state;\n  var selection = state.selection;\n  if (!selection || !selection.empty) {\n    return {\n      top: -1000,\n      right: 0\n    };\n  }\n  var $anchor = selection.$anchor;\n  if ($anchor.pos === 0) {\n    return {\n      top: -1000,\n      right: 0\n    };\n  }\n  var resolvedPos = state.doc.resolve($anchor.pos);\n  var rowNumber = resolvedPos.path[1];\n  var i = 0;\n  var firstNode = (0, prosemirror_utils_1.findChildren)(state.doc, function (_node) {\n    if (rowNumber === i || rowNumber + 1 === i) {\n      i++;\n      return true;\n    }\n    i++;\n    return false;\n  }, false)[0];\n  if (!firstNode) {\n    return {\n      top: -1000\n    };\n  }\n  var coords = view.coordsAtPos(firstNode.pos);\n  var dom = view.nodeDOM(firstNode.pos);\n  var elementTop = (0, utils_1.getOffset)(dom).top;\n  var offsetTop = (0, utils_1.getOffset)(view.dom).top;\n  if (coords.top === 0) {\n    return {\n      top: -1000\n    };\n  }\n  if (dom && dom.offsetHeight) {\n    return {\n      left: 5,\n      top: elementTop + dom.offsetHeight - offsetTop + 20\n    };\n  }\n  return {\n    left: 5,\n    top: elementTop - offsetTop + 20\n  };\n};\nvar getActiveMenu = function (props) {\n  var menu = props.menu,\n    view = props.view;\n  var state = view.state;\n  var activeItem = menu.find(function (item) {\n    if (item.active && item.active(state)) {\n      return true;\n    }\n    return false;\n  });\n  if (activeItem && activeItem.customMenu) {\n    return React.createElement(React.Fragment, null, activeItem.customMenu(view));\n  }\n  return React.createElement(React.Fragment, null);\n};\nvar shouldRenderMenu = function (props) {\n  var menu = props.menu,\n    view = props.view;\n  var node = (0, utils_1.getParentNodeFromState)(view.state);\n  if (!node || !menu || !menu.length) {\n    return;\n  }\n  var name = node.type.name;\n  var selectedItem = menu.find(function (item) {\n    if (item.name === name) {\n      return true;\n    }\n    return false;\n  });\n  if (!selectedItem) {\n    return true;\n  }\n  if (selectedItem.hideMenuOnFocus) {\n    return false;\n  }\n  return true;\n};\nexports.default = function (props) {\n  var menu = props.menu,\n    view = props.view;\n  var state = view.state,\n    dispatch = view.dispatch;\n  var CustomMenu = getActiveMenu(props);\n  var shouldRender = shouldRenderMenu(props);\n  var _a = useState({\n      left: 0,\n      top: 0\n    }),\n    style = _a[0],\n    setState = _a[1];\n  useEffect(function () {\n    var nextStyle = calculateStyle(props);\n    setState(nextStyle);\n  }, [props]);\n  if (!shouldRender) {\n    return null;\n  }\n  var hideMenuOnFocus = false;\n  var activeItem = menu.find(function (item) {\n    if (item.active && item.active(state)) {\n      return true;\n    }\n    return false;\n  });\n  if (activeItem && activeItem.hideBlockMenuOnFocus) {\n    hideMenuOnFocus = true;\n  }\n  return React.createElement(\"div\", {\n    style: style,\n    className: \"smartblock-menu\"\n  }, React.createElement(\"div\", {\n    className: \"smartblock-menu-top\"\n  }, menu.map(function (item, key) {\n    if (item.customButton) {\n      return item.customButton({\n        state: state,\n        dispatch: dispatch\n      });\n    }\n    return React.createElement(button_1.default, {\n      key: key,\n      type: \"button\",\n      active: item.active && item.active(state),\n      disabled: item.enable && !item.enable(state) || hideMenuOnFocus,\n      onClick: function (e) {\n        e.preventDefault();\n        item.onClick(state, dispatch, view);\n      }\n    }, typeof item.icon !== 'string' ? item.icon : React.createElement(\"span\", {\n      dangerouslySetInnerHTML: {\n        __html: item.icon\n      }\n    }));\n  })), CustomMenu && CustomMenu.props && CustomMenu.props.children && React.createElement(\"div\", {\n    className: \"smartblock-custom-menu\"\n  }, CustomMenu));\n};","\"use strict\";\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n    return t;\n  };\n  return __assign.apply(this, arguments);\n};\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar React = require(\"react\");\nvar SvgUndo = function (props) {\n  return React.createElement(\"svg\", __assign({\n    width: 1792,\n    height: 1792,\n    viewBox: \"0 0 1792 1792\"\n  }, props), React.createElement(\"title\", null, \"undo\"), React.createElement(\"g\", {\n    id: \"bebf11ee-5e4c-414b-9c0e-9afbb64c0153\",\n    \"data-name\": \"\\\\u30E9\\\\u30D9\\\\u30EB\"\n  }, React.createElement(\"path\", {\n    d: \"M715.62,1146.77v412.47L0,843.62,715.62,128V510.8l356.57,39.61c395.14,43.91,676.64,243.79,716.86,492,31.48,194.23-94.21,351.37-190.3,420.9-106.64,77.16-245,118.33-401.49,76.89,119.27-39.75,212.14-134.61,207.69-214.79-7-125.53-148.89-178.63-452-178.63Z\"\n  })));\n};\nexports.default = SvgUndo;","/**\n * Module dependencies.\n */\n\nvar Tween = require('tween');\nvar raf = require('raf');\n\n/**\n * Expose `scrollTo`.\n */\n\nmodule.exports = scrollTo;\n\n/**\n * Scroll to `(x, y)`.\n *\n * @param {Number} x\n * @param {Number} y\n * @api public\n */\n\nfunction scrollTo(x, y, options) {\n  options = options || {};\n\n  // start position\n  var start = scroll();\n\n  // setup tween\n  var tween = Tween(start).ease(options.ease || 'out-circ').to({\n    top: y,\n    left: x\n  }).duration(options.duration || 1000);\n\n  // scroll\n  tween.update(function (o) {\n    window.scrollTo(o.left | 0, o.top | 0);\n  });\n\n  // handle end\n  tween.on('end', function () {\n    animate = function () {};\n  });\n\n  // animate\n  function animate() {\n    raf(animate);\n    tween.update();\n  }\n  animate();\n  return tween;\n}\n\n/**\n * Return scroll position.\n *\n * @return {Object}\n * @api private\n */\n\nfunction scroll() {\n  var y = window.pageYOffset || document.documentElement.scrollTop;\n  var x = window.pageXOffset || document.documentElement.scrollLeft;\n  return {\n    top: y,\n    left: x\n  };\n}","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar React = require(\"react\");\nvar utils_1 = require(\"../utils\");\nvar button_1 = require(\"./button\");\nvar useRef = React.useRef;\nvar ARROWOFFSET = 50;\nvar ARROWTOPOFFSET = 25;\nvar calculateStyle = function (view, container) {\n  var selection = view.state.selection;\n  var offsetLeft = (0, utils_1.getOffset)(view.dom).left;\n  var coords = view.coordsAtPos(selection.$head.pos);\n  var offsetTop = (0, utils_1.getOffset)(view.dom).top;\n  var top = coords.top + (0, utils_1.getScrollTop)() + ARROWTOPOFFSET - offsetTop;\n  var left = coords.left - ARROWOFFSET - offsetLeft;\n  if (container && container.current && container.current.offsetWidth) {\n    var width = container.current.offsetWidth;\n    if (left + width > window.innerWidth) {\n      return {\n        top: top,\n        left: window.innerWidth - width\n      };\n    }\n  }\n  return {\n    left: left,\n    top: top\n  };\n};\nvar getActiveInlineMenu = function (props) {\n  var blockMenu = props.blockMenu,\n    view = props.view;\n  var state = view.state;\n  var activeItem = blockMenu.find(function (item) {\n    if (item.active && item.active(state)) {\n      return true;\n    }\n    return false;\n  });\n  if (activeItem && activeItem.customInlineMenu) {\n    return React.createElement(React.Fragment, null, activeItem.customInlineMenu(view));\n  }\n  return false;\n};\nvar calculateArrowPos = function (view, container) {\n  var selection = view.state.selection;\n  var offsetLeft = (0, utils_1.getOffset)(view.dom).left;\n  var coords = view.coordsAtPos(selection.$head.pos);\n  var left = coords.left - ARROWOFFSET - offsetLeft;\n  var width = container.current ? container.current.offsetWidth : 0;\n  if (container && container.current && container.current.offsetWidth) {\n    if (left + width > window.innerWidth) {\n      return left - window.innerWidth + width;\n    }\n  }\n  return 20;\n};\nvar MenuBar = function (_a) {\n  var menu = _a.menu,\n    blockMenu = _a.blockMenu,\n    children = _a.children,\n    view = _a.view;\n  var state = view.state,\n    dispatch = view.dispatch;\n  var selection = view.state.selection;\n  var container = useRef(null);\n  var style = calculateStyle(view, container);\n  var pos = calculateArrowPos(view, container);\n  var inlineMenu = getActiveInlineMenu({\n    blockMenu: blockMenu,\n    view: view\n  });\n  if (!selection || selection.empty) {\n    return React.createElement(React.Fragment, null);\n  }\n  if (menu.length === 0) {\n    return React.createElement(React.Fragment, null);\n  }\n  return React.createElement(\"div\", {\n    style: style,\n    ref: container,\n    className: \"smartblock-inline-menu\"\n  }, React.createElement(\"div\", {\n    className: \"smartblock-inline-menu-arrow\",\n    style: {\n      left: \"\".concat(pos, \"px\")\n    }\n  }), React.createElement(\"div\", {\n    className: \"smartblock-inline-menu-inner\"\n  }, children, menu.map(function (item, key) {\n    return React.createElement(button_1.default, {\n      key: \"inline-\".concat(key),\n      type: \"button\",\n      active: item.active && item.active(state),\n      // title={item.title}\n      disabled: item.enable && !item.enable(state),\n      onClick: function (e) {\n        e.preventDefault();\n        item.onClick(state, dispatch);\n      }\n    }, typeof item.icon !== 'string' ? item.icon : React.createElement(\"span\", {\n      dangerouslySetInnerHTML: {\n        __html: item.icon\n      }\n    }));\n  }), inlineMenu && inlineMenu.props && inlineMenu.props.children && React.createElement(React.Fragment, null, inlineMenu)));\n};\nexports.default = MenuBar;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar paragraph_1 = require(\"./paragraph\");\nvar trash_1 = require(\"./trash\");\nvar move_up_1 = require(\"./move-up\");\nvar move_down_1 = require(\"./move-down\");\nvar default_keys_1 = require(\"./default-keys\");\nvar default_plugins_1 = require(\"./default-plugins\");\nexports.default = [\n// blocks\nnew paragraph_1.default(), new move_down_1.default(), new move_up_1.default(), new trash_1.default(), new default_keys_1.default(), new default_plugins_1.default()];","/**\n * EvEmitter v1.1.0\n * Lil' event emitter\n * MIT License\n */\n\n/* jshint unused: true, undef: true, strict: true */\n\n(function (global, factory) {\n  // universal module definition\n  /* jshint strict: false */ /* globals define, module, window */\n  if (typeof define == 'function' && define.amd) {\n    // AMD - RequireJS\n    define(factory);\n  } else if (typeof module == 'object' && module.exports) {\n    // CommonJS - Browserify, Webpack\n    module.exports = factory();\n  } else {\n    // Browser globals\n    global.EvEmitter = factory();\n  }\n})(typeof window != 'undefined' ? window : this, function () {\n  \"use strict\";\n\n  function EvEmitter() {}\n  var proto = EvEmitter.prototype;\n  proto.on = function (eventName, listener) {\n    if (!eventName || !listener) {\n      return;\n    }\n    // set events hash\n    var events = this._events = this._events || {};\n    // set listeners array\n    var listeners = events[eventName] = events[eventName] || [];\n    // only add once\n    if (listeners.indexOf(listener) == -1) {\n      listeners.push(listener);\n    }\n    return this;\n  };\n  proto.once = function (eventName, listener) {\n    if (!eventName || !listener) {\n      return;\n    }\n    // add event\n    this.on(eventName, listener);\n    // set once flag\n    // set onceEvents hash\n    var onceEvents = this._onceEvents = this._onceEvents || {};\n    // set onceListeners object\n    var onceListeners = onceEvents[eventName] = onceEvents[eventName] || {};\n    // set flag\n    onceListeners[listener] = true;\n    return this;\n  };\n  proto.off = function (eventName, listener) {\n    var listeners = this._events && this._events[eventName];\n    if (!listeners || !listeners.length) {\n      return;\n    }\n    var index = listeners.indexOf(listener);\n    if (index != -1) {\n      listeners.splice(index, 1);\n    }\n    return this;\n  };\n  proto.emitEvent = function (eventName, args) {\n    var listeners = this._events && this._events[eventName];\n    if (!listeners || !listeners.length) {\n      return;\n    }\n    // copy over to avoid interference if .off() in listener\n    listeners = listeners.slice(0);\n    args = args || [];\n    // once stuff\n    var onceListeners = this._onceEvents && this._onceEvents[eventName];\n    for (var i = 0; i < listeners.length; i++) {\n      var listener = listeners[i];\n      var isOnce = onceListeners && onceListeners[listener];\n      if (isOnce) {\n        // remove listener\n        // remove before trigger to prevent recursion\n        this.off(eventName, listener);\n        // unset once flag\n        delete onceListeners[listener];\n      }\n      // trigger listener\n      listener.apply(this, args);\n    }\n    return this;\n  };\n  proto.allOff = function () {\n    delete this._events;\n    delete this._onceEvents;\n  };\n  return EvEmitter;\n});","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar React = require(\"react\");\nvar imagesloaded_1 = require(\"imagesloaded\");\nvar utils_1 = require(\"../utils\");\nvar useState = React.useState,\n  useEffect = React.useEffect;\nvar getCustomLayout = function (props) {\n  var menu = props.menu,\n    view = props.view;\n  var node = (0, utils_1.getParentNodeFromState)(view.state);\n  if (!node || !menu || !menu.length) {\n    return;\n  }\n  var name = node.type.name;\n  var selectedItem = menu.find(function (item) {\n    if (item.name === name) {\n      return true;\n    }\n    return false;\n  });\n  if (!selectedItem) {\n    return null;\n  }\n  if (selectedItem.customLayout) {\n    return selectedItem.customLayout;\n  }\n  return null;\n};\nvar useImagesLoaded = function (dom) {\n  var _a = useState({\n      top: 0,\n      left: 0,\n      width: 0,\n      height: 0\n    }),\n    size = _a[0],\n    setSize = _a[1];\n  useEffect(function () {\n    (0, imagesloaded_1.default)(dom, function () {\n      var newSize = dom.getBoundingClientRect();\n      if (size.height !== newSize.height) {\n        setSize(newSize);\n      }\n    });\n  });\n  return size;\n};\nexports.default = function (props) {\n  var customLayout = getCustomLayout(props);\n  if (!customLayout) {\n    return null;\n  }\n  var view = props.view;\n  var pos = (0, utils_1.calculateStyle)(props.view);\n  var parentNode = (0, utils_1.getParentNodeFromState)(view.state);\n  var parentPos = (0, utils_1.findNodePosition)(view.state.doc, parentNode);\n  var dom = view.nodeDOM(parentPos);\n  var style = {\n    position: 'absolute',\n    zIndex: 10,\n    top: pos.top,\n    left: 0,\n    right: 0\n  };\n  var size = useImagesLoaded(dom);\n  if (!size.height) {\n    return null;\n  }\n  return React.createElement(\"div\", {\n    style: style\n  }, customLayout(props.view, dom));\n};","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar React = require(\"react\");\nvar prosemirror_utils_1 = require(\"prosemirror-utils\");\nvar utils_1 = require(\"../utils\");\nvar button_1 = require(\"./button\");\nvar useState = React.useState,\n  useEffect = React.useEffect;\nvar getContainerOffset = function (container) {\n  return (0, utils_1.getOffset)(container).top;\n};\nvar calculateStyle = function (props) {\n  var view = props.view;\n  var state = view.state;\n  var selection = state.selection;\n  if (!selection) {\n    return {\n      top: -1000\n    };\n  }\n  var $anchor = selection.$anchor;\n  var resolvedPos = state.doc.resolve($anchor.pos);\n  var rowNumber = resolvedPos.path[1];\n  var i = 0;\n  if ($anchor.pos === 0) {\n    return {\n      top: -1000\n    };\n  }\n  var firstNode = (0, prosemirror_utils_1.findChildren)(state.doc, function (_node) {\n    if (rowNumber === i || rowNumber + 1 === i) {\n      i++;\n      return true;\n    }\n    i++;\n    return false;\n  }, false)[0];\n  if (!firstNode) {\n    return {\n      top: -1000\n    };\n  }\n  var coords = view.coordsAtPos(firstNode.pos);\n  var dom = view.nodeDOM(firstNode.pos);\n  var elementTop = (0, utils_1.getOffset)(dom).top;\n  var offsetTop = getContainerOffset(view.dom);\n  if (coords.top === 0) {\n    return {\n      top: -1000\n    };\n  }\n  return {\n    right: 20,\n    top: elementTop - offsetTop - 40\n  };\n};\nexports.default = function (props) {\n  var _a = useState({\n      right: 20,\n      top: 0\n    }),\n    style = _a[0],\n    setState = _a[1];\n  var menu = props.menu,\n    view = props.view;\n  var state = view.state,\n    dispatch = view.dispatch;\n  useEffect(function () {\n    var nextStyle = calculateStyle(props);\n    setState(nextStyle);\n  }, [props]);\n  return React.createElement(\"div\", {\n    style: style,\n    className: \"smartblock-edit-menu\"\n  }, menu.map(function (item, key) {\n    return React.createElement(button_1.default, {\n      className: \"smartblock-edit-btn\",\n      key: \"edit-\".concat(key),\n      type: \"button\",\n      color: item.btnColor,\n      active: item.active && item.active(state),\n      disabled: item.enable && !item.enable(state),\n      onClick: function (e) {\n        e.preventDefault();\n        item.onClick(state, dispatch, view);\n      }\n    }, item.icon);\n  }));\n};","/**\n * Module dependencies.\n */\n\nvar Emitter = require('emitter');\nvar clone = require('clone');\nvar type = require('type');\nvar ease = require('ease');\n\n/**\n * Expose `Tween`.\n */\n\nmodule.exports = Tween;\n\n/**\n * Initialize a new `Tween` with `obj`.\n *\n * @param {Object|Array} obj\n * @api public\n */\n\nfunction Tween(obj) {\n  if (!(this instanceof Tween)) return new Tween(obj);\n  this._from = obj;\n  this.ease('linear');\n  this.duration(500);\n}\n\n/**\n * Mixin emitter.\n */\n\nEmitter(Tween.prototype);\n\n/**\n * Reset the tween.\n *\n * @api public\n */\n\nTween.prototype.reset = function () {\n  this.isArray = 'array' === type(this._from);\n  this._curr = clone(this._from);\n  this._done = false;\n  this._start = Date.now();\n  return this;\n};\n\n/**\n * Tween to `obj` and reset internal state.\n *\n *    tween.to({ x: 50, y: 100 })\n *\n * @param {Object|Array} obj\n * @return {Tween} self\n * @api public\n */\n\nTween.prototype.to = function (obj) {\n  this.reset();\n  this._to = obj;\n  return this;\n};\n\n/**\n * Set duration to `ms` [500].\n *\n * @param {Number} ms\n * @return {Tween} self\n * @api public\n */\n\nTween.prototype.duration = function (ms) {\n  this._duration = ms;\n  return this;\n};\n\n/**\n * Set easing function to `fn`.\n *\n *    tween.ease('in-out-sine')\n *\n * @param {String|Function} fn\n * @return {Tween}\n * @api public\n */\n\nTween.prototype.ease = function (fn) {\n  fn = 'function' == typeof fn ? fn : ease[fn];\n  if (!fn) throw new TypeError('invalid easing function');\n  this._ease = fn;\n  return this;\n};\n\n/**\n * Stop the tween and immediately emit \"stop\" and \"end\".\n *\n * @return {Tween}\n * @api public\n */\n\nTween.prototype.stop = function () {\n  this.stopped = true;\n  this._done = true;\n  this.emit('stop');\n  this.emit('end');\n  return this;\n};\n\n/**\n * Perform a step.\n *\n * @return {Tween} self\n * @api private\n */\n\nTween.prototype.step = function () {\n  if (this._done) return;\n\n  // duration\n  var duration = this._duration;\n  var now = Date.now();\n  var delta = now - this._start;\n  var done = delta >= duration;\n\n  // complete\n  if (done) {\n    this._from = this._to;\n    this._update(this._to);\n    this._done = true;\n    this.emit('end');\n    return this;\n  }\n\n  // tween\n  var from = this._from;\n  var to = this._to;\n  var curr = this._curr;\n  var fn = this._ease;\n  var p = (now - this._start) / duration;\n  var n = fn(p);\n\n  // array\n  if (this.isArray) {\n    for (var i = 0; i < from.length; ++i) {\n      curr[i] = from[i] + (to[i] - from[i]) * n;\n    }\n    this._update(curr);\n    return this;\n  }\n\n  // objech\n  for (var k in from) {\n    curr[k] = from[k] + (to[k] - from[k]) * n;\n  }\n  this._update(curr);\n  return this;\n};\n\n/**\n * Set update function to `fn` or\n * when no argument is given this performs\n * a \"step\".\n *\n * @param {Function} fn\n * @return {Tween} self\n * @api public\n */\n\nTween.prototype.update = function (fn) {\n  if (0 == arguments.length) return this.step();\n  this._update = fn;\n  return this;\n};","/**\n * Expose `requestAnimationFrame()`.\n */\n\nexports = module.exports = window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || fallback;\n\n/**\n * Fallback implementation.\n */\n\nvar prev = new Date().getTime();\nfunction fallback(fn) {\n  var curr = new Date().getTime();\n  var ms = Math.max(0, 16 - (curr - prev));\n  var req = setTimeout(fn, ms);\n  prev = curr;\n  return req;\n}\n\n/**\n * Cancel.\n */\n\nvar cancel = window.cancelAnimationFrame || window.webkitCancelAnimationFrame || window.mozCancelAnimationFrame || window.clearTimeout;\nexports.cancel = function (id) {\n  cancel.call(window, id);\n};","/**\n * Expose `Emitter`.\n */\n\nmodule.exports = Emitter;\n\n/**\n * Initialize a new `Emitter`.\n *\n * @api public\n */\n\nfunction Emitter(obj) {\n  if (obj) return mixin(obj);\n}\n;\n\n/**\n * Mixin the emitter properties.\n *\n * @param {Object} obj\n * @return {Object}\n * @api private\n */\n\nfunction mixin(obj) {\n  for (var key in Emitter.prototype) {\n    obj[key] = Emitter.prototype[key];\n  }\n  return obj;\n}\n\n/**\n * Listen on the given `event` with `fn`.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.on = Emitter.prototype.addEventListener = function (event, fn) {\n  this._callbacks = this._callbacks || {};\n  (this._callbacks['$' + event] = this._callbacks['$' + event] || []).push(fn);\n  return this;\n};\n\n/**\n * Adds an `event` listener that will be invoked a single\n * time then automatically removed.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.once = function (event, fn) {\n  function on() {\n    this.off(event, on);\n    fn.apply(this, arguments);\n  }\n  on.fn = fn;\n  this.on(event, on);\n  return this;\n};\n\n/**\n * Remove the given callback for `event` or all\n * registered callbacks.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.off = Emitter.prototype.removeListener = Emitter.prototype.removeAllListeners = Emitter.prototype.removeEventListener = function (event, fn) {\n  this._callbacks = this._callbacks || {};\n\n  // all\n  if (0 == arguments.length) {\n    this._callbacks = {};\n    return this;\n  }\n\n  // specific event\n  var callbacks = this._callbacks['$' + event];\n  if (!callbacks) return this;\n\n  // remove all handlers\n  if (1 == arguments.length) {\n    delete this._callbacks['$' + event];\n    return this;\n  }\n\n  // remove specific handler\n  var cb;\n  for (var i = 0; i < callbacks.length; i++) {\n    cb = callbacks[i];\n    if (cb === fn || cb.fn === fn) {\n      callbacks.splice(i, 1);\n      break;\n    }\n  }\n  return this;\n};\n\n/**\n * Emit `event` with the given args.\n *\n * @param {String} event\n * @param {Mixed} ...\n * @return {Emitter}\n */\n\nEmitter.prototype.emit = function (event) {\n  this._callbacks = this._callbacks || {};\n  var args = [].slice.call(arguments, 1),\n    callbacks = this._callbacks['$' + event];\n  if (callbacks) {\n    callbacks = callbacks.slice(0);\n    for (var i = 0, len = callbacks.length; i < len; ++i) {\n      callbacks[i].apply(this, args);\n    }\n  }\n  return this;\n};\n\n/**\n * Return array of callbacks for `event`.\n *\n * @param {String} event\n * @return {Array}\n * @api public\n */\n\nEmitter.prototype.listeners = function (event) {\n  this._callbacks = this._callbacks || {};\n  return this._callbacks['$' + event] || [];\n};\n\n/**\n * Check if this emitter has `event` handlers.\n *\n * @param {String} event\n * @return {Boolean}\n * @api public\n */\n\nEmitter.prototype.hasListeners = function (event) {\n  return !!this.listeners(event).length;\n};","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar React = require(\"react\");\nvar hooks_1 = require(\"../utils/hooks\");\nvar useRef = React.useRef,\n  useEffect = React.useEffect;\nexports.default = function (props) {\n  var editorRef = useRef(null);\n  var view = (0, hooks_1.useView)(props);\n  // Object.keys(props.options).forEach((key) => console.log(key, {...props.options[key]}))\n  useEffect(function () {\n    if (editorRef.current) {\n      editorRef.current.appendChild(view.dom);\n    }\n    if (props.autoFocus) {\n      view.focus();\n    }\n  }, []);\n  var scrolling = (0, hooks_1.useScrolling)(editorRef, 300);\n  var editor = React.createElement(\"div\", {\n    ref: editorRef\n  });\n  return props.render({\n    editor: editor,\n    view: view,\n    scrolling: scrolling\n  });\n};","/**\n * Module dependencies.\n */\n\nvar type;\ntry {\n  type = require('component-type');\n} catch (_) {\n  type = require('type');\n}\n\n/**\n * Module exports.\n */\n\nmodule.exports = clone;\n\n/**\n * Clones objects.\n *\n * @param {Mixed} any object\n * @api public\n */\n\nfunction clone(obj) {\n  switch (type(obj)) {\n    case 'object':\n      var copy = {};\n      for (var key in obj) {\n        if (obj.hasOwnProperty(key)) {\n          copy[key] = clone(obj[key]);\n        }\n      }\n      return copy;\n    case 'array':\n      var copy = new Array(obj.length);\n      for (var i = 0, l = obj.length; i < l; i++) {\n        copy[i] = clone(obj[i]);\n      }\n      return copy;\n    case 'regexp':\n      // from millermedeiros/amd-utils - MIT\n      var flags = '';\n      flags += obj.multiline ? 'm' : '';\n      flags += obj.global ? 'g' : '';\n      flags += obj.ignoreCase ? 'i' : '';\n      return new RegExp(obj.source, flags);\n    case 'date':\n      return new Date(obj.getTime());\n    default:\n      // string, number, boolean, \n      return obj;\n  }\n}","// easing functions from \"Tween.js\"\n\nexports.linear = function (n) {\n  return n;\n};\nexports.inQuad = function (n) {\n  return n * n;\n};\nexports.outQuad = function (n) {\n  return n * (2 - n);\n};\nexports.inOutQuad = function (n) {\n  n *= 2;\n  if (n < 1) return 0.5 * n * n;\n  return -0.5 * (--n * (n - 2) - 1);\n};\nexports.inCube = function (n) {\n  return n * n * n;\n};\nexports.outCube = function (n) {\n  return --n * n * n + 1;\n};\nexports.inOutCube = function (n) {\n  n *= 2;\n  if (n < 1) return 0.5 * n * n * n;\n  return 0.5 * ((n -= 2) * n * n + 2);\n};\nexports.inQuart = function (n) {\n  return n * n * n * n;\n};\nexports.outQuart = function (n) {\n  return 1 - --n * n * n * n;\n};\nexports.inOutQuart = function (n) {\n  n *= 2;\n  if (n < 1) return 0.5 * n * n * n * n;\n  return -0.5 * ((n -= 2) * n * n * n - 2);\n};\nexports.inQuint = function (n) {\n  return n * n * n * n * n;\n};\nexports.outQuint = function (n) {\n  return --n * n * n * n * n + 1;\n};\nexports.inOutQuint = function (n) {\n  n *= 2;\n  if (n < 1) return 0.5 * n * n * n * n * n;\n  return 0.5 * ((n -= 2) * n * n * n * n + 2);\n};\nexports.inSine = function (n) {\n  return 1 - Math.cos(n * Math.PI / 2);\n};\nexports.outSine = function (n) {\n  return Math.sin(n * Math.PI / 2);\n};\nexports.inOutSine = function (n) {\n  return .5 * (1 - Math.cos(Math.PI * n));\n};\nexports.inExpo = function (n) {\n  return 0 == n ? 0 : Math.pow(1024, n - 1);\n};\nexports.outExpo = function (n) {\n  return 1 == n ? n : 1 - Math.pow(2, -10 * n);\n};\nexports.inOutExpo = function (n) {\n  if (0 == n) return 0;\n  if (1 == n) return 1;\n  if ((n *= 2) < 1) return .5 * Math.pow(1024, n - 1);\n  return .5 * (-Math.pow(2, -10 * (n - 1)) + 2);\n};\nexports.inCirc = function (n) {\n  return 1 - Math.sqrt(1 - n * n);\n};\nexports.outCirc = function (n) {\n  return Math.sqrt(1 - --n * n);\n};\nexports.inOutCirc = function (n) {\n  n *= 2;\n  if (n < 1) return -0.5 * (Math.sqrt(1 - n * n) - 1);\n  return 0.5 * (Math.sqrt(1 - (n -= 2) * n) + 1);\n};\nexports.inBack = function (n) {\n  var s = 1.70158;\n  return n * n * ((s + 1) * n - s);\n};\nexports.outBack = function (n) {\n  var s = 1.70158;\n  return --n * n * ((s + 1) * n + s) + 1;\n};\nexports.inOutBack = function (n) {\n  var s = 1.70158 * 1.525;\n  if ((n *= 2) < 1) return 0.5 * (n * n * ((s + 1) * n - s));\n  return 0.5 * ((n -= 2) * n * ((s + 1) * n + s) + 2);\n};\nexports.inBounce = function (n) {\n  return 1 - exports.outBounce(1 - n);\n};\nexports.outBounce = function (n) {\n  if (n < 1 / 2.75) {\n    return 7.5625 * n * n;\n  } else if (n < 2 / 2.75) {\n    return 7.5625 * (n -= 1.5 / 2.75) * n + 0.75;\n  } else if (n < 2.5 / 2.75) {\n    return 7.5625 * (n -= 2.25 / 2.75) * n + 0.9375;\n  } else {\n    return 7.5625 * (n -= 2.625 / 2.75) * n + 0.984375;\n  }\n};\nexports.inOutBounce = function (n) {\n  if (n < .5) return exports.inBounce(n * 2) * .5;\n  return exports.outBounce(n * 2 - 1) * .5 + .5;\n};\n\n// aliases\n\nexports['in-quad'] = exports.inQuad;\nexports['out-quad'] = exports.outQuad;\nexports['in-out-quad'] = exports.inOutQuad;\nexports['in-cube'] = exports.inCube;\nexports['out-cube'] = exports.outCube;\nexports['in-out-cube'] = exports.inOutCube;\nexports['in-quart'] = exports.inQuart;\nexports['out-quart'] = exports.outQuart;\nexports['in-out-quart'] = exports.inOutQuart;\nexports['in-quint'] = exports.inQuint;\nexports['out-quint'] = exports.outQuint;\nexports['in-out-quint'] = exports.inOutQuint;\nexports['in-sine'] = exports.inSine;\nexports['out-sine'] = exports.outSine;\nexports['in-out-sine'] = exports.inOutSine;\nexports['in-expo'] = exports.inExpo;\nexports['out-expo'] = exports.outExpo;\nexports['in-out-expo'] = exports.inOutExpo;\nexports['in-circ'] = exports.inCirc;\nexports['out-circ'] = exports.outCirc;\nexports['in-out-circ'] = exports.inOutCirc;\nexports['in-back'] = exports.inBack;\nexports['out-back'] = exports.outBack;\nexports['in-out-back'] = exports.inOutBack;\nexports['in-bounce'] = exports.inBounce;\nexports['out-bounce'] = exports.outBounce;\nexports['in-out-bounce'] = exports.inOutBounce;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar React = require(\"react\");\nvar prosemirror_history_1 = require(\"prosemirror-history\");\nvar undo_1 = require(\"./icons/undo\");\nexports.default = function (props) {\n  var _a = props.view,\n    state = _a.state,\n    dispatch = _a.dispatch;\n  var depth = (0, prosemirror_history_1.undoDepth)(state);\n  if (!depth) {\n    return React.createElement(React.Fragment, null);\n  }\n  return React.createElement(\"button\", {\n    className: \"smartblock-backbtn\",\n    onClick: function () {\n      (0, prosemirror_history_1.undo)(state, dispatch);\n    }\n  }, React.createElement(undo_1.default, {\n    style: {\n      width: '24px',\n      height: '24px'\n    }\n  }));\n};","/**\n * toString ref.\n */\n\nvar toString = Object.prototype.toString;\n\n/**\n * Return the type of `val`.\n *\n * @param {Mixed} val\n * @return {String}\n * @api public\n */\n\nmodule.exports = function (val) {\n  switch (toString.call(val)) {\n    case '[object Date]':\n      return 'date';\n    case '[object RegExp]':\n      return 'regexp';\n    case '[object Arguments]':\n      return 'arguments';\n    case '[object Array]':\n      return 'array';\n    case '[object Error]':\n      return 'error';\n  }\n  if (val === null) return 'null';\n  if (val === undefined) return 'undefined';\n  if (val !== val) return 'nan';\n  if (val && val.nodeType === 1) return 'element';\n  val = val.valueOf ? val.valueOf() : Object.prototype.valueOf.apply(val);\n  return typeof val;\n};","/*!\n * imagesLoaded v4.1.4\n * JavaScript is all like \"You images are done yet or what?\"\n * MIT License\n */\n\n(function (window, factory) {\n  'use strict';\n\n  // universal module definition\n\n  /*global define: false, module: false, require: false */\n  if (typeof define == 'function' && define.amd) {\n    // AMD\n    define(['ev-emitter/ev-emitter'], function (EvEmitter) {\n      return factory(window, EvEmitter);\n    });\n  } else if (typeof module == 'object' && module.exports) {\n    // CommonJS\n    module.exports = factory(window, require('ev-emitter'));\n  } else {\n    // browser global\n    window.imagesLoaded = factory(window, window.EvEmitter);\n  }\n})(typeof window !== 'undefined' ? window : this,\n// --------------------------  factory -------------------------- //\n\nfunction factory(window, EvEmitter) {\n  'use strict';\n\n  var $ = window.jQuery;\n  var console = window.console;\n\n  // -------------------------- helpers -------------------------- //\n\n  // extend objects\n  function extend(a, b) {\n    for (var prop in b) {\n      a[prop] = b[prop];\n    }\n    return a;\n  }\n  var arraySlice = Array.prototype.slice;\n\n  // turn element or nodeList into an array\n  function makeArray(obj) {\n    if (Array.isArray(obj)) {\n      // use object if already an array\n      return obj;\n    }\n    var isArrayLike = typeof obj == 'object' && typeof obj.length == 'number';\n    if (isArrayLike) {\n      // convert nodeList to array\n      return arraySlice.call(obj);\n    }\n\n    // array of single index\n    return [obj];\n  }\n\n  // -------------------------- imagesLoaded -------------------------- //\n\n  /**\n   * @param {Array, Element, NodeList, String} elem\n   * @param {Object or Function} options - if function, use as callback\n   * @param {Function} onAlways - callback function\n   */\n  function ImagesLoaded(elem, options, onAlways) {\n    // coerce ImagesLoaded() without new, to be new ImagesLoaded()\n    if (!(this instanceof ImagesLoaded)) {\n      return new ImagesLoaded(elem, options, onAlways);\n    }\n    // use elem as selector string\n    var queryElem = elem;\n    if (typeof elem == 'string') {\n      queryElem = document.querySelectorAll(elem);\n    }\n    // bail if bad element\n    if (!queryElem) {\n      console.error('Bad element for imagesLoaded ' + (queryElem || elem));\n      return;\n    }\n    this.elements = makeArray(queryElem);\n    this.options = extend({}, this.options);\n    // shift arguments if no options set\n    if (typeof options == 'function') {\n      onAlways = options;\n    } else {\n      extend(this.options, options);\n    }\n    if (onAlways) {\n      this.on('always', onAlways);\n    }\n    this.getImages();\n    if ($) {\n      // add jQuery Deferred object\n      this.jqDeferred = new $.Deferred();\n    }\n\n    // HACK check async to allow time to bind listeners\n    setTimeout(this.check.bind(this));\n  }\n  ImagesLoaded.prototype = Object.create(EvEmitter.prototype);\n  ImagesLoaded.prototype.options = {};\n  ImagesLoaded.prototype.getImages = function () {\n    this.images = [];\n\n    // filter & find items if we have an item selector\n    this.elements.forEach(this.addElementImages, this);\n  };\n\n  /**\n   * @param {Node} element\n   */\n  ImagesLoaded.prototype.addElementImages = function (elem) {\n    // filter siblings\n    if (elem.nodeName == 'IMG') {\n      this.addImage(elem);\n    }\n    // get background image on element\n    if (this.options.background === true) {\n      this.addElementBackgroundImages(elem);\n    }\n\n    // find children\n    // no non-element nodes, #143\n    var nodeType = elem.nodeType;\n    if (!nodeType || !elementNodeTypes[nodeType]) {\n      return;\n    }\n    var childImgs = elem.querySelectorAll('img');\n    // concat childElems to filterFound array\n    for (var i = 0; i < childImgs.length; i++) {\n      var img = childImgs[i];\n      this.addImage(img);\n    }\n\n    // get child background images\n    if (typeof this.options.background == 'string') {\n      var children = elem.querySelectorAll(this.options.background);\n      for (i = 0; i < children.length; i++) {\n        var child = children[i];\n        this.addElementBackgroundImages(child);\n      }\n    }\n  };\n  var elementNodeTypes = {\n    1: true,\n    9: true,\n    11: true\n  };\n  ImagesLoaded.prototype.addElementBackgroundImages = function (elem) {\n    var style = getComputedStyle(elem);\n    if (!style) {\n      // Firefox returns null if in a hidden iframe https://bugzil.la/548397\n      return;\n    }\n    // get url inside url(\"...\")\n    var reURL = /url\\((['\"])?(.*?)\\1\\)/gi;\n    var matches = reURL.exec(style.backgroundImage);\n    while (matches !== null) {\n      var url = matches && matches[2];\n      if (url) {\n        this.addBackground(url, elem);\n      }\n      matches = reURL.exec(style.backgroundImage);\n    }\n  };\n\n  /**\n   * @param {Image} img\n   */\n  ImagesLoaded.prototype.addImage = function (img) {\n    var loadingImage = new LoadingImage(img);\n    this.images.push(loadingImage);\n  };\n  ImagesLoaded.prototype.addBackground = function (url, elem) {\n    var background = new Background(url, elem);\n    this.images.push(background);\n  };\n  ImagesLoaded.prototype.check = function () {\n    var _this = this;\n    this.progressedCount = 0;\n    this.hasAnyBroken = false;\n    // complete if no images\n    if (!this.images.length) {\n      this.complete();\n      return;\n    }\n    function onProgress(image, elem, message) {\n      // HACK - Chrome triggers event before object properties have changed. #83\n      setTimeout(function () {\n        _this.progress(image, elem, message);\n      });\n    }\n    this.images.forEach(function (loadingImage) {\n      loadingImage.once('progress', onProgress);\n      loadingImage.check();\n    });\n  };\n  ImagesLoaded.prototype.progress = function (image, elem, message) {\n    this.progressedCount++;\n    this.hasAnyBroken = this.hasAnyBroken || !image.isLoaded;\n    // progress event\n    this.emitEvent('progress', [this, image, elem]);\n    if (this.jqDeferred && this.jqDeferred.notify) {\n      this.jqDeferred.notify(this, image);\n    }\n    // check if completed\n    if (this.progressedCount == this.images.length) {\n      this.complete();\n    }\n    if (this.options.debug && console) {\n      console.log('progress: ' + message, image, elem);\n    }\n  };\n  ImagesLoaded.prototype.complete = function () {\n    var eventName = this.hasAnyBroken ? 'fail' : 'done';\n    this.isComplete = true;\n    this.emitEvent(eventName, [this]);\n    this.emitEvent('always', [this]);\n    if (this.jqDeferred) {\n      var jqMethod = this.hasAnyBroken ? 'reject' : 'resolve';\n      this.jqDeferred[jqMethod](this);\n    }\n  };\n\n  // --------------------------  -------------------------- //\n\n  function LoadingImage(img) {\n    this.img = img;\n  }\n  LoadingImage.prototype = Object.create(EvEmitter.prototype);\n  LoadingImage.prototype.check = function () {\n    // If complete is true and browser supports natural sizes,\n    // try to check for image status manually.\n    var isComplete = this.getIsImageComplete();\n    if (isComplete) {\n      // report based on naturalWidth\n      this.confirm(this.img.naturalWidth !== 0, 'naturalWidth');\n      return;\n    }\n\n    // If none of the checks above matched, simulate loading on detached element.\n    this.proxyImage = new Image();\n    this.proxyImage.addEventListener('load', this);\n    this.proxyImage.addEventListener('error', this);\n    // bind to image as well for Firefox. #191\n    this.img.addEventListener('load', this);\n    this.img.addEventListener('error', this);\n    this.proxyImage.src = this.img.src;\n  };\n  LoadingImage.prototype.getIsImageComplete = function () {\n    // check for non-zero, non-undefined naturalWidth\n    // fixes Safari+InfiniteScroll+Masonry bug infinite-scroll#671\n    return this.img.complete && this.img.naturalWidth;\n  };\n  LoadingImage.prototype.confirm = function (isLoaded, message) {\n    this.isLoaded = isLoaded;\n    this.emitEvent('progress', [this, this.img, message]);\n  };\n\n  // ----- events ----- //\n\n  // trigger specified handler for event type\n  LoadingImage.prototype.handleEvent = function (event) {\n    var method = 'on' + event.type;\n    if (this[method]) {\n      this[method](event);\n    }\n  };\n  LoadingImage.prototype.onload = function () {\n    this.confirm(true, 'onload');\n    this.unbindEvents();\n  };\n  LoadingImage.prototype.onerror = function () {\n    this.confirm(false, 'onerror');\n    this.unbindEvents();\n  };\n  LoadingImage.prototype.unbindEvents = function () {\n    this.proxyImage.removeEventListener('load', this);\n    this.proxyImage.removeEventListener('error', this);\n    this.img.removeEventListener('load', this);\n    this.img.removeEventListener('error', this);\n  };\n\n  // -------------------------- Background -------------------------- //\n\n  function Background(url, element) {\n    this.url = url;\n    this.element = element;\n    this.img = new Image();\n  }\n\n  // inherit LoadingImage prototype\n  Background.prototype = Object.create(LoadingImage.prototype);\n  Background.prototype.check = function () {\n    this.img.addEventListener('load', this);\n    this.img.addEventListener('error', this);\n    this.img.src = this.url;\n    // check if image is already complete\n    var isComplete = this.getIsImageComplete();\n    if (isComplete) {\n      this.confirm(this.img.naturalWidth !== 0, 'naturalWidth');\n      this.unbindEvents();\n    }\n  };\n  Background.prototype.unbindEvents = function () {\n    this.img.removeEventListener('load', this);\n    this.img.removeEventListener('error', this);\n  };\n  Background.prototype.confirm = function (isLoaded, message) {\n    this.isLoaded = isLoaded;\n    this.emitEvent('progress', [this, this.element, message]);\n  };\n\n  // -------------------------- jQuery -------------------------- //\n\n  ImagesLoaded.makeJQueryPlugin = function (jQuery) {\n    jQuery = jQuery || window.jQuery;\n    if (!jQuery) {\n      return;\n    }\n    // set local variable\n    $ = jQuery;\n    // $().imagesLoaded()\n    $.fn.imagesLoaded = function (options, callback) {\n      var instance = new ImagesLoaded(this, options, callback);\n      return instance.jqDeferred.promise($(this));\n    };\n  };\n  // try making plugin\n  ImagesLoaded.makeJQueryPlugin();\n\n  // --------------------------  -------------------------- //\n\n  return ImagesLoaded;\n});"],"sourceRoot":""}